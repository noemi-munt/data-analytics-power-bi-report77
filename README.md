# Data Analytics - Power BI Report

## 1. Gather the Data
The Customers, Orders, Products, and Stores tables were imported from various sources including Azure Blob Storage and Azure SQL Database. The tables were cleaned by removing null/ empty records, deleting unnnecesary columns, and ensuring consistent naming conventions.

## 2. Create the Date Table
Created the date table using the following DAX expression 
``` DAX 
Date Table =
CALENDAR(
    MIN(Orders[Order Date]),
    MAX(Orders[Order Date])
)
```
This creates the date table from the first to the most recent order.

## 3. Build the Star Schema Data Model

![image](https://github.com/user-attachments/assets/07b7c31c-15ce-4706-b2d0-86506afda870)

Summary of relationships:
- Products[product_code] to Orders[product_code]
- Stores[store code] to Orders[Store Code]
- Customers[User UUID] to Orders[User ID]
- Date[date] to Orders[Order Date]
- Date[date] to Orders[Shipping Date]

## 4. Create Key Measures
Total Orders 
``` DAX
Total Orders = COUNTROWS(Orders)
```

Total Revenue
``` DAX
Total Revenue = SUMX(
    Orders,
    Orders[Product Quantity] * RELATED(Products[Sale Price])
)
```
Total Profit 
``` DAX
Total Profit = SUMX(
    Orders,
    Orders[Product Quantity] * (RELATED(Products[Sale Price]) - RELATED(Products[Cost Price]))
    )

```
Total Customers
``` DAX
Total Customers = COUNTA(Customers[User UUID])
```

Total Quantity: counts the number of items sold in the Orders table
``` DAX
Total Quantity = SUM(Orders[Product Quantity])
```

Profit YTD: calculates the total profit for the current year
``` DAX
Profit YTD = TOTALYTD (
    SUMX (Orders,
    Orders[Product Quantity] * (RELATED(Products[Sale Price]) - RELATED(Products[Cost Price]))),
    Orders[Order Date] 
)
```
Revenue YTD: calculates the total revenue for the current year
``` DAX
Revenue YTD = TOTALYTD(
    SUMX(
    Orders,
    Orders[Product Quantity] * RELATED(Products[Sale Price])
    ),
    Orders[Order Date]
)
```

## 5. Create Date & Geography Hierarchies
I created hierarchies to help filter and visualise data later on. To create a geography hierarchy, two new calculated columns in the Stores table called Country and Geography were added.

The Country column was calculated by using the country code. 
``` DAX 
Country = 
IF( 
    Stores[Country Code] = "GB", 
    "Great Britain",
    IF(
        Stores[Country Code] = "DE", 
        "Germany",
        "United States"
    )
)
```
The Geography was created by concatenating the country name and region.

``` DAX
Geography = CONCATENATE(
    Stores[Country Region], 
    CONCATENATE(", ", Stores[Country])
)
```

## 6. Create the Customer Summary Page
The customer summary page includes the following visualisations

- A donut chart of the total customers of each country
- A donut chart of the number of customers who purchased each product category
- A line chart of the total customers over time
- A table of the top 20 customers by revenue
- A set of three cards of the top customer by revenue, including their name, total number of orders placed, and the total revenue generated by the customer.

![image](https://github.com/user-attachments/assets/3e1b7748-3b3a-445c-b792-c78037362a3f)

## 7. Create an Executive Summary Page
The Executive Summary page includes the following visuals: 
- Cards to display the Total Revenue, Total Orders and Total Profit measures
- A line chart of the revenue over time, setup in the same way as the line chart from the Customer Detail page.
- Donut charts of the Total Revenue by Country and Total Revenue by Store Type
- A bar chart of the Total Orders by the Product Category
- 3 KPIs of the  Quarterly Revenue, Orders and Profit.

### Create KPI visuals

To create KPIs for Quarterly Revenue, Orders and Profit I created a set of new measures for the quarterly targets.
- Previous Quarter Profit
- Previous Quarter Revenue
- Previous Quarter Orders
- Targets, equal to 5% growth in each measure compared to the previous quarter

To calculate the previous quarter, I used the `DATEADD` function as I encountered filtering issues with `PREVIOUSQUARTER` function.
``` DAX 
Previous Quarter Orders =
CALCULATE([Total Orders], DATEADD('Date Table'[Date], -1, QUARTER))
```
The create the target measures, I used the following DAX expression.
``` DAX
Target Orders = [Previous Quarter Orders] * 1.05
```
To set up a new KPI for the orders:

- The Value field should be Total Orders
- The Trend Axis should be Start of Quarter
- The Target should be Target Orders
The same process was used to calculate the KPIs for Quarterly Revenue and Profit.

![image](https://github.com/user-attachments/assets/fd470b46-8433-4024-bcf6-22e588edc6e7)

## 8. Create a Product Detail Page

The Product Detail Page includes:
- 3 gauge visuals
- Table of the top 10 products
- Line graph of total revenue by product category over time
- Scatter graph of profit per item vs quantity of item sold by product category
- Slicer toolbar

### 8.1 Creating the gauge visuals
The gauges show the current-quarter performance of Orders, Revenue and Profit against a quarterly target. The targets are a 10% quarter-on-quarter growth in all three metrics.

The target DAX measures are defined as:
``` DAX
10% Target Orders = 1.1 * [Previous Quarter Orders]
```
This defines the maximum value of the gauge.
The current number of orders this quarter is calculated similarly to the Previous Quarter Orders, except the offset in the `DATEADD` is 0.
``` DAX
Current Quarter Orders = 
CALCULATE([Total Orders], DATEADD('Date Table'[Date], 0, QUARTER))
```
To apply conditional formatting to the callout values, we calculate the difference between the target and current value of the metric. The default colour is red, when the difference is zero the callout value is black.

### 8.2 Create a Slicer Toolbar
To reduce the visual clutter of the visuals we need to use slicers. To create a clean page, we have created a slicer toolbar to hide the slicers. Using buttons and bookmarks to hide different views, you can easily filter the data as shown in the screenshots below. The filter states are shown in the cards on the top left corner. 

The DAX measures displaying the slicer filter state are defined as follows:
``` DAX
Category Selection = 
IF(
    ISFILTERED(Products[Category]), 
    IF(
        HASONEVALUE(Products[Category]), 
        SELECTEDVALUE(Products[Category]), 
        "Various Selected"
    ), 
    "No Selection"
)
```
The same is used to display the `Stores[Country]` selection.

Notes:
- Ensure the bookmark Slicer Bar Closed has the data unchecked. This ensures the bookmark does not override slicer selections when you close it.

![image](https://github.com/user-attachments/assets/43bfb0a3-99e3-4971-98d1-61f829a15145)

![image](https://github.com/user-attachments/assets/6dd07f56-ff7f-48cf-bebd-181b23cc5523)

## 9. Create a Stores Map Page
The Stores Map page includes 
- A map visual
- A ` Stores[Country]` slicer

Set the controls of your map as follows:
- Auto-Zoom: On
- Zoom buttons: Off
- Lasso button: Off

Assign the Geography hierarchy to the Location field, and ProfitYTD to the Bubble size field
Set the slicer field to `Stores[Country]`, and allow Multi-select with Ctrl/Cmd and Show "Select All" as an option in the slicer.

![image](https://github.com/user-attachments/assets/36999040-073f-49ef-a4c1-99e22ae4794e)

### 9.1 Create a Stores Drillthrough page
This page includes the following visuals:

- A table showing the top 5 products based on Total Orders, with columns: Description, Profit YTD, Total Orders, Total Revenue
- A column chart showing Total Orders by product category for the store
- Gauges for Profit YTD against a profit target of 20% year-on-year growth vs. the same period in the previous year. 
- A Card visual showing the currently selected store
  
![image](https://github.com/user-attachments/assets/1046e0d8-d0a8-4a1c-8652-484b79b313c7)

### 9.2 Create a Stores Tooltip page
Create a custom tooltip to see each store's year-to-date profit performance against the profit target by hovering the mouse over a store on the map. To do this, create a Stores Tooltip page, and copy over the profit gauge visual, then set the tooltip of the map visual to the Stores Tooltip page.

![image](https://github.com/user-attachments/assets/61ecd8ee-bb8a-4fc9-b0ab-4c2d49c5350a)



